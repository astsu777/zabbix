<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>7.4</version>
    <template_groups>
        <template_group>
            <uuid>7df96b18c230490a9a0a9e2307226338</uuid>
            <name>Templates</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>199c6d1910594cfda4df56070f1b8cbd</uuid>
            <template>NUT</template>
            <name>NUT</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>cbe1415589db4bb9a52cb9d2b7e16be1</uuid>
                    <name>UPS Battery Charge</name>
                    <key>system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'battery.charge:'| cut -d &quot; &quot; -f2]</key>
                    <trends>0</trends>
                    <units>%</units>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>NUT</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>1c5b5e84e9a14f58a3349f694411e9e8</uuid>
                            <expression>last(/NUT/system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'battery.charge:'| cut -d &quot; &quot; -f2],#1)&lt;20</expression>
                            <name>Battery capacity is critical</name>
                            <event_name>Battery capacity is critical: {ITEM.VALUE}</event_name>
                            <priority>HIGH</priority>
                        </trigger>
                        <trigger>
                            <uuid>7ccb9ea822bf44088ba118d7ded40fe0</uuid>
                            <expression>last(/NUT/system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'battery.charge:'| cut -d &quot; &quot; -f2],#1)&lt;50</expression>
                            <name>Battery capacity is low</name>
                            <event_name>Battery capacity is low: {ITEM.VALUE}</event_name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>a458d64f7643473fa28738e512ffa6f9</uuid>
                    <name>UPS Battery Runtime</name>
                    <key>system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'battery.runtime:'| cut -d &quot; &quot; -f2]</key>
                    <trends>0</trends>
                    <units>s</units>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>NUT</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0cce884fe4f84e489220085fada25eca</uuid>
                    <name>UPS Manufacturer</name>
                    <key>system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'device.mfr:'| cut -d &quot; &quot; -f2]</key>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>NUT</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7fea066e613f45d48bc39a32fb3edf50</uuid>
                    <name>UPS Device Model</name>
                    <key>system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'device.model:'| awk -F': ' '{print $2}']</key>
                    <value_type>TEXT</value_type>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>NUT</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>781076f4b2f3446b8e9e722e8dc02be7</uuid>
                            <expression>bitlength(last(/NUT/system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'device.model:'| awk -F': ' '{print $2}']))=0</expression>
                            <name>UPS is not detected</name>
                            <event_name>UPS is not detected: {ITEM.VALUE}</event_name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$NUT_SERVER}</macro>
                    <description>FQDN/IP address of the remote NUT server</description>
                </macro>
                <macro>
                    <macro>{$UPS_NAME}</macro>
                    <value>ups</value>
                    <description>Name of the remote UPS</description>
                </macro>
            </macros>
        </template>
    </templates>
    <graphs>
        <graph>
            <uuid>1b22f73b1edd42bdb38bba9d2d709aac</uuid>
            <name>UPS Battery</name>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>274482</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>NUT</host>
                        <key>system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'battery.runtime:'| cut -d &quot; &quot; -f2]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <yaxisside>RIGHT</yaxisside>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>NUT</host>
                        <key>system.run[/usr/bin/upsc {$UPS_NAME}@{$NUT_SERVER} 2&gt;/dev/null |grep 'battery.charge:'| cut -d &quot; &quot; -f2]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
